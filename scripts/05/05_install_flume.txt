sudo -s
cd /usr/local
export FLUME_VERSION=1.11.0
wget https://archive.apache.org/dist/flume/${FLUME_VERSION}/apache-flume-${FLUME_VERSION}-bin.tar.gz
tar -xzf apache-flume-${FLUME_VERSION}-bin.tar.gz
ln -s apache-flume-${FLUME_VERSION}-bin flume
chown -R hduser:hadoop apache-flume-${FLUME_VERSION}-bin

su - hduser

cat >> ~/.bashrc <<!
export FLUME_HOME=/usr/local/flume
export PATH=\$PATH:\$FLUME_HOME/bin
if [ -z "\$CLASSPATH" ]; then
   export CLASSPATH=\$FLUME_HOME/lib
else
   export CLASSPATH=\$CLASSPATH:\$FLUME_HOME/lib
fi
!

source ~/.bashrc

cd $FLUME_HOME/conf

cp -p  flume-env.sh.template flume-env.sh
cp -p flume-conf.properties.template flume-conf.properties

# entweder ans Ende der Datei hÃ¤ngen oder besser im File an der Stelle ersetzen
cat >>flume-env.sh <<!
export JAVA_HOME=/usr/lib/jvm/jdk
export JAVA_OPTS="-Xms100m -Xmx2000m -Dcom.sun.management.jmxremote"
export FLUME_CLASSPATH="/usr/local/flume/lib/*"
!

flume-ng version

# erzeuge Sequence Generator
cat >$FLUME_HOME/conf/seq_gen.conf <<!

# Naming the components on the current agent 

SeqGenAgent.sources = SeqSource   
SeqGenAgent.channels = MemChannel 
SeqGenAgent.sinks = HDFS 
 
# Describing/Configuring the source 
SeqGenAgent.sources.SeqSource.type = seq
  
# Describing/Configuring the sink
SeqGenAgent.sinks.HDFS.type = hdfs 
SeqGenAgent.sinks.HDFS.hdfs.path = hdfs://namenode:9000/user/hduser
SeqGenAgent.sinks.HDFS.hdfs.filePrefix = log 
SeqGenAgent.sinks.HDFS.hdfs.rollInterval = 0
SeqGenAgent.sinks.HDFS.hdfs.rollCount = 10000
SeqGenAgent.sinks.HDFS.hdfs.fileType = DataStream 
 
# Describing/Configuring the channel 
SeqGenAgent.channels.MemChannel.type = memory 
SeqGenAgent.channels.MemChannel.capacity = 1000 
SeqGenAgent.channels.MemChannel.transactionCapacity = 100 
 
# Binding the source and sink to the channel 
SeqGenAgent.sources.SeqSource.channels = MemChannel
SeqGenAgent.sinks.HDFS.channel = MemChannel
!

# for the Twitter agent
cat >$FLUME_HOME/conf/twitter_agent.conf <<!
# Naming the components on the current agent. 
TwitterAgent.sources = Twitter 
TwitterAgent.channels = MemChannel 
TwitterAgent.sinks = HDFS
  
# Describing/Configuring the source 
TwitterAgent.sources.Twitter.type = org.apache.flume.source.twitter.TwitterSource
TwitterAgent.sources.Twitter.consumerKey = Your OAuth consumer key
TwitterAgent.sources.Twitter.consumerSecret = Your OAuth consumer secret 
TwitterAgent.sources.Twitter.accessToken = Your OAuth consumer key access token 
TwitterAgent.sources.Twitter.accessTokenSecret = Your OAuth consumer key access token secret 
TwitterAgent.sources.Twitter.keywords = Tennis,ATP,Djokovic,Nadal,Federer,Thiem
  
# Describing/Configuring the sink 

TwitterAgent.sinks.HDFS.type = hdfs 
TwitterAgent.sinks.HDFS.hdfs.path = hdfs://localhost:9000/user/twitter_data/
TwitterAgent.sinks.HDFS.hdfs.fileType = DataStream 
TwitterAgent.sinks.HDFS.hdfs.writeFormat = Text 
TwitterAgent.sinks.HDFS.hdfs.batchSize = 1000
TwitterAgent.sinks.HDFS.hdfs.rollSize = 0 
TwitterAgent.sinks.HDFS.hdfs.rollCount = 10000
TwitterAgent.sinks.HDFS.hdfs.rollInterval = 600 
 
# Describing/Configuring the channel 
TwitterAgent.channels.MemChannel.type = memory 
TwitterAgent.channels.MemChannel.capacity = 10000 
TwitterAgent.channels.MemChannel.transactionCapacity = 1000
  
# Binding the source and sink to the channel 
TwitterAgent.sources.Twitter.channels = MemChannel
TwitterAgent.sinks.HDFS.channel = MemChannel
!